<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Farmasi â€” Daftar Modul & Kuis</title>
<link rel="stylesheet" href="../assets/css/farmasi.css">
<style>
  body{max-width:980px;margin:0 auto;padding:22px;color:#eef2ff;background:#0b1740;font:16px/1.5 system-ui,Segoe UI,Inter,Arial}
  h1{margin:0 0 6px} .muted{opacity:.8;margin:0 0 16px}
  .tools{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0 16px}
  input[type=search]{flex:1;min-width:240px;padding:10px 12px;border-radius:12px;border:1px solid #2a2e5e;background:#121739;color:#fff}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
  .card{border:1px solid #2a2e5e;border-radius:14px;background:#171b3f;padding:14px}
  .tag{display:inline-block;font-size:12px;border:1px solid #2a2e5e;border-radius:999px;padding:3px 8px;margin-right:6px;opacity:.85}
  a.btn{display:inline-block;margin-top:10px;padding:8px 12px;border-radius:10px;border:1px solid #2a2e5e;color:#fff;text-decoration:none}
  a.btn:hover{border-color:#60a5fa}
  .small{font-size:13px;opacity:.85}
</style>
</head>
<body>
  <h1>ðŸ“š Farmasi â€” Daftar Modul & Kuis</h1>
  <p class="muted">Otomatis membaca semua file <code>materi-*.html</code> & <code>kuis-*.html</code> di folder ini.</p>

  <div class="tools">
    <input id="q" type="search" placeholder="Cari (mis. biokimia, anatomi, modul 2, kuis)â€¦">
    <span class="small" id="count"></span>
  </div>

  <div id="list" class="grid"></div>

<script>
// === KONFIGURASI â€” ganti jika namamu/reponya beda ===
const OWNER = 'septianamufarohah1986-netizen';
const REPO  = 'septiana1986portal';
const PATH  = 'pages/farmasi';

// mapping judul cantik
function prettyName(filename){
  // contoh: kuis-biokimia-modul2.html â†’ [Kuis] Biokimia â€” Modul 2
  const base = filename.replace('.html','');
  let kind = base.startsWith('kuis-') ? 'Kuis' : (base.startsWith('materi-') ? 'Materi' : 'File');
  const parts = base.split('-').slice(1); // buang prefix kuis/materi
  // gabung hingga kata 'modulX'
  const modulIdx = parts.findIndex(p=>/^modul\d+$/i.test(p));
  const topic = parts.slice(0, modulIdx<0? undefined : modulIdx).join(' ').replaceAll('_',' ').trim();
  const modul = modulIdx>=0 ? ('Modul ' + parts[modulIdx].replace(/[^0-9]/g,'')) : '';
  const title = `${topic ? capitalize(topic) : base}`;
  return { kind, title, modul };
}
function capitalize(s){ return s? s.replace(/\b([a-z])/g, m=>m.toUpperCase()) : s; }

// panggil GitHub API (public, tanpa token)
async function fetchFolder(){
  const url = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${PATH}`;
  const res = await fetch(url, { headers: { 'Accept':'application/vnd.github+json' } });
  if(!res.ok) throw new Error('Gagal ambil daftar file');
  return res.json();
}

function render(items){
  const list = document.getElementById('list');
  const q = (document.getElementById('q').value||'').toLowerCase();
  const filtered = items.filter(it=>{
    const hay = (it.name + ' ' + (it._pretty.title||'') + ' ' + (it._pretty.modul||'') + ' ' + it._pretty.kind).toLowerCase();
    return hay.includes(q);
  });
  document.getElementById('count').textContent = `${filtered.length} file ditampilkan`;
  list.innerHTML = filtered.map(it=>{
    const p = it._pretty;
    const nice = `${p.kind} â€” ${p.title}${p.modul? ' ('+p.modul+')':''}`;
    return `<article class="card">
      <div class="small">
        <span class="tag">${p.kind}</span>
        ${p.modul? `<span class="tag">${p.modul}</span>`:''}
      </div>
      <h3 style="margin:6px 0 8px">${nice}</h3>
      <a class="btn" href="./${it.name}">Buka â†’</a>
    </article>`;
  }).join('');
}

(async ()=>{
  try{
    const files = await fetchFolder();
    const htmls = files
      .filter(f=>f.type==='file' && /\.html$/i.test(f.name))
      .filter(f=>/^kuis-|^materi-/i.test(f.name))   // hanya kuis-/materi-
      .sort((a,b)=> a.name.localeCompare(b.name));

    htmls.forEach(f=> f._pretty = prettyName(f.name));
    render(htmls);

    document.getElementById('q').addEventListener('input', ()=>render(htmls));
  }catch(e){
    document.getElementById('list').innerHTML =
      `<article class="card"><strong>Gagal memuat daftar.</strong><p class="small">${e.message}</p>
       <p class="small">Pastikan repo <code>${OWNER}/${REPO}</code> public dan file tersimpan di <code>/${PATH}</code>.</p></article>`;
    console.error(e);
  }
})();
</script>
</body>
</html>
